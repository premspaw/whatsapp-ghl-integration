#!/usr/bin/env node

const fs = require('fs');
const path = require('path');

console.log('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');
console.log('   Quick .env Setup - Minimal Configuration');
console.log('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n');

// Check if .env already exists
const envPath = path.join(__dirname, '.env');
if (fs.existsSync(envPath)) {
  console.log('âš ï¸  .env file already exists!');
  console.log('\nOptions:');
  console.log('1. Delete existing .env and run this script again');
  console.log('2. Manually edit the existing .env file');
  console.log('3. Run: node setup-env-interactive.js (for guided setup)\n');
  process.exit(0);
}

// Create minimal .env with defaults
const minimalEnv = `# WhatsApp to GHL Integration - Environment Configuration
# Quick Setup - Edit these values as needed

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# SERVER CONFIGURATION
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
PORT=3000
NODE_ENV=development

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# WHATSAPP CONFIGURATION
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
WHATSAPP_SESSION_NAME=Mywhatsapp
USE_MOCK_WHATSAPP=true
FILTER_GROUP_MESSAGES=true
FILTER_BROADCAST_MESSAGES=true
FILTER_COMPANY_MESSAGES=true

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# GOHIGHLEVEL API CONFIGURATION (REQUIRED for GHL sync)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Get from: GHL Settings â†’ API â†’ Generate API Key
GHL_API_KEY=
GHL_LOCATION_ID=
GHL_BASE_URL=https://services.leadconnectorhq.com
GHL_CHANNEL_MODE=sms

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# DATABASE CONFIGURATION (SUPABASE) - REQUIRED for persistence
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Get from: https://app.supabase.com â†’ Your Project â†’ Settings â†’ API
SUPABASE_URL=
SUPABASE_SERVICE_ROLE_KEY=
SUPABASE_ANON_KEY=
SUPABASE_SCHEMA=public

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# AI CONFIGURATION (OPTIONAL but recommended)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Option 1: OpenRouter (recommended)
# Get from: https://openrouter.ai/keys
OPENROUTER_API_KEY=
OPENROUTER_MODEL=anthropic/claude-3-haiku
OPENROUTER_REFERER=http://localhost:3000

# Option 2: OpenAI (alternative)
# Get from: https://platform.openai.com/api-keys
# OPENAI_API_KEY=

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# SMS CONFIGURATION (OPTIONAL)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
SMS_PROVIDER=twilio
# TWILIO_ACCOUNT_SID=
# TWILIO_AUTH_TOKEN=
# TWILIO_FROM_NUMBER=

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# EMAIL CONFIGURATION (OPTIONAL)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# EMAIL_HOST=smtp.gmail.com
# EMAIL_PORT=587
# EMAIL_SECURE=false
# EMAIL_USER=
# EMAIL_PASS=
# EMAIL_FROM=
`;

try {
  fs.writeFileSync(envPath, minimalEnv);
  console.log('âœ… .env file created successfully!\n');
  
  console.log('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');
  console.log('   What was created:');
  console.log('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n');
  console.log('âœ… Basic server configuration (ready to use)');
  console.log('âœ… Mock WhatsApp mode enabled (for testing)');
  console.log('âš ï¸  GHL API credentials (need to be added)');
  console.log('âš ï¸  Supabase database (need to be added)');
  console.log('âšª AI, SMS, Email (optional, commented out)\n');

  console.log('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');
  console.log('   Quick Test (No setup required):');
  console.log('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n');
  console.log('You can start the server RIGHT NOW to test:');
  console.log('   npm start');
  console.log('   Open: http://localhost:3000\n');
  console.log('This will run in MOCK mode with test data.\n');

  console.log('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');
  console.log('   To Add Real Credentials:');
  console.log('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n');
  
  console.log('1ï¸âƒ£  GOHIGHLEVEL (for contact/message sync):');
  console.log('   â€¢ Login to GoHighLevel');
  console.log('   â€¢ Go to Settings â†’ API');
  console.log('   â€¢ Generate API Key');
  console.log('   â€¢ Copy Location ID from dashboard URL');
  console.log('   â€¢ Edit .env and add:\n');
  console.log('     GHL_API_KEY=your_key_here');
  console.log('     GHL_LOCATION_ID=your_location_id\n');

  console.log('2ï¸âƒ£  SUPABASE (for database persistence):');
  console.log('   â€¢ Go to https://supabase.com');
  console.log('   â€¢ Create new project');
  console.log('   â€¢ Go to Settings â†’ API');
  console.log('   â€¢ Copy: URL, Service Role Key, Anon Key');
  console.log('   â€¢ Edit .env and add credentials');
  console.log('   â€¢ Run migrations: data/migrations/*.sql\n');

  console.log('3ï¸âƒ£  AI PROVIDER (for smart replies):');
  console.log('   â€¢ Option A - OpenRouter (recommended):');
  console.log('     - Go to https://openrouter.ai');
  console.log('     - Create account and generate key');
  console.log('     - Add to .env: OPENROUTER_API_KEY=sk-or-v1-...\n');
  console.log('   â€¢ Option B - OpenAI:');
  console.log('     - Go to https://platform.openai.com');
  console.log('     - Generate API key');
  console.log('     - Add to .env: OPENAI_API_KEY=sk-...\n');

  console.log('4ï¸âƒ£  REAL WHATSAPP (when ready):');
  console.log('   â€¢ Edit .env: USE_MOCK_WHATSAPP=false');
  console.log('   â€¢ Restart server: npm start');
  console.log('   â€¢ Scan QR code with WhatsApp mobile app\n');

  console.log('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');
  console.log('   Useful Commands:');
  console.log('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n');
  console.log('Start server:           npm start');
  console.log('Test all features:      node test-complete-flow.js');
  console.log('Interactive setup:      node setup-env-interactive.js');
  console.log('View status:            cat PROJECT_STATUS_SUMMARY.md\n');

  console.log('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');
  console.log('   Need Help?');
  console.log('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n');
  console.log('ğŸ“š Read: QUICK_CHECKLIST.md');
  console.log('ğŸ“š Read: PROJECT_STATUS_SUMMARY.md');
  console.log('ğŸ“š Read: QUICK_START.md\n');

} catch (error) {
  console.error('âŒ Error creating .env file:', error.message);
  process.exit(1);
}

